var idbModules={util:{cleanInterface:!1}};(function(){"use strict";var n={test:!0};if(Object.defineProperty)try{Object.defineProperty(n,"test",{enumerable:!1});n.test&&(idbModules.util.cleanInterface=!0)}catch(t){}})(),function(n){"use strict";function r(n,t,i){i.target=t;typeof t[n]=="function"&&t[n].apply(t,[i])}var t=function(){this.length=0;this._items=[];n.util.cleanInterface&&Object.defineProperty(this,"_items",{enumerable:!1})},i;if(t.prototype={contains:function(n){return-1!==this._items.indexOf(n)},item:function(n){return this._items[n]},indexOf:function(n){return this._items.indexOf(n)},push:function(n){this._items.push(n);this.length+=1;for(var t=0;t<this._items.length;t++)this[t]=this._items[t]},splice:function(){this._items.splice.apply(this._items,arguments);this.length=this._items.length;for(var n in this)n===String(parseInt(n,10))&&delete this[n];for(n=0;n<this._items.length;n++)this[n]=this._items[n]}},n.util.cleanInterface)for(i in{indexOf:!1,push:!1,splice:!1})Object.defineProperty(t.prototype,i,{enumerable:!1});n.util.callback=r;n.util.StringList=t;n.util.quote=function(n){return'"'+n+'"'}}(idbModules),function(n){"use strict";function h(){(navigator.userAgent.match(/MSIE/)||navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/))&&c()}function c(){var h=IDBFactory.prototype.cmp,c=IDBDatabase.prototype.createObjectStore,l=IDBObjectStore.prototype.createIndex,a=IDBObjectStore.prototype.add,v=IDBObjectStore.prototype.put,y=IDBIndex.prototype.get,p=IDBIndex.prototype.getKey,w=IDBIndex.prototype.openCursor,b=IDBIndex.prototype.openKeyCursor,k=IDBObjectStore.prototype.get,d=IDBObjectStore.prototype.delete,g=IDBObjectStore.prototype.openCursor,nt=IDBObjectStore.prototype.openKeyCursor,tt=IDBKeyRange.bound,it=IDBKeyRange.upperBound,rt=IDBKeyRange.lowerBound,ut=IDBKeyRange.only,n=Object.getOwnPropertyDescriptor(IDBRequest.prototype,"result"),i=Object.getOwnPropertyDescriptor(IDBCursor.prototype,"primaryKey"),f=Object.getOwnPropertyDescriptor(IDBCursor.prototype,"key"),s=Object.getOwnPropertyDescriptor(IDBCursorWithValue.prototype,"value");IDBFactory.prototype.cmp=function(n,i){var r=Array.prototype.slice.call(arguments);return n instanceof Array&&(r[0]=t(n)),i instanceof Array&&(r[1]=t(i)),h.apply(this,r)};IDBDatabase.prototype.createObjectStore=function(n,t){return t&&t.keyPath instanceof Array&&(t.keyPath=e(t.keyPath)),c.apply(this,arguments)};IDBObjectStore.prototype.createIndex=function(n,t){var i=Array.prototype.slice.call(arguments);return t instanceof Array&&(i[1]=e(t)),l.apply(this,i)};IDBObjectStore.prototype.add=function(){return this.__insertData(a,arguments)};IDBObjectStore.prototype.put=function(){return this.__insertData(v,arguments)};IDBObjectStore.prototype.__insertData=function(n,i){var r,e,f,s;if(i=Array.prototype.slice.call(i),r=i[0],e=i[1],e instanceof Array&&(i[1]=t(e)),typeof r=="object")for(u(this.keyPath)&&o(r,this.keyPath),f=0;f<this.indexNames.length;f++)if(s=this.index(this.indexNames[f]),u(s.keyPath))try{o(r,s.keyPath)}catch(h){}return n.apply(this,i)};IDBIndex.prototype.get=function(n){var i=Array.prototype.slice.call(arguments);return n instanceof Array&&(i[0]=t(n)),y.apply(this,i)};IDBIndex.prototype.getKey=function(n){var i=Array.prototype.slice.call(arguments);return n instanceof Array&&(i[0]=t(n)),p.apply(this,i)};IDBIndex.prototype.openCursor=function(n){var i=Array.prototype.slice.call(arguments);return n instanceof Array&&(i[0]=t(n)),w.apply(this,i)};IDBIndex.prototype.openKeyCursor=function(n){var i=Array.prototype.slice.call(arguments);return n instanceof Array&&(i[0]=t(n)),b.apply(this,i)};IDBObjectStore.prototype.get=function(n){var i=Array.prototype.slice.call(arguments);return n instanceof Array&&(i[0]=t(n)),k.apply(this,i)};IDBObjectStore.prototype.delete=function(n){var i=Array.prototype.slice.call(arguments);return n instanceof Array&&(i[0]=t(n)),d.apply(this,i)};IDBObjectStore.prototype.openCursor=function(n){var i=Array.prototype.slice.call(arguments);return n instanceof Array&&(i[0]=t(n)),g.apply(this,i)};IDBObjectStore.prototype.openKeyCursor=function(n){var i=Array.prototype.slice.call(arguments);return n instanceof Array&&(i[0]=t(n)),nt.apply(this,i)};IDBKeyRange.bound=function(n,i){var r=Array.prototype.slice.call(arguments);return n instanceof Array&&(r[0]=t(n)),i instanceof Array&&(r[1]=t(i)),tt.apply(IDBKeyRange,r)};IDBKeyRange.upperBound=function(n){var i=Array.prototype.slice.call(arguments);return n instanceof Array&&(i[0]=t(n)),it.apply(IDBKeyRange,i)};IDBKeyRange.lowerBound=function(n){var i=Array.prototype.slice.call(arguments);return n instanceof Array&&(i[0]=t(n)),rt.apply(IDBKeyRange,i)};IDBKeyRange.only=function(n){var i=Array.prototype.slice.call(arguments);return n instanceof Array&&(i[0]=t(n)),ut.apply(IDBKeyRange,i)};Object.defineProperty(IDBRequest.prototype,"result",{enumerable:n.enumerable,configurable:n.configurable,get:function(){var t=n.get.call(this);return r(t)}});Object.defineProperty(IDBCursor.prototype,"primaryKey",{enumerable:i.enumerable,configurable:i.configurable,get:function(){var n=i.get.call(this);return r(n)}});Object.defineProperty(IDBCursor.prototype,"key",{enumerable:f.enumerable,configurable:f.configurable,get:function(){var n=f.get.call(this);return r(n)}});Object.defineProperty(IDBCursorWithValue.prototype,"value",{enumerable:s.enumerable,configurable:s.configurable,get:function(){var n=s.get.call(this);return r(n)}});try{IDBTransaction.VERSION_CHANGE||(IDBTransaction.VERSION_CHANGE="versionchange")}catch(ft){}}function u(n){return n&&n.indexOf(i+".")===0}function e(n){for(var t=0;t<n.length;t++)n[t]=n[t].replace(/\./g,a);return i+"."+n.join(f)}function v(n){n=n.substr(i.length+1);n=n.split(f);for(var t=0;t<n.length;t++)n[t]=n[t].replace(l,".");return n}function o(r,u){var f=v(u),e=n.Key.getValue(r,f),o=t(e);u=u.substr(i.length+1);r[i]=r[i]||{};r[i][u]=o}function r(n){return typeof n=="string"&&u(n)?y(n):(n&&typeof n[i]=="object"&&delete n[i],n)}function t(t){return n.Key.validate(t),t=n.Key.encode(t),t=i+"."+t,s(t),t}function y(t){return s(t),t=t.substr(i.length+1),n.Key.decode(t)}function s(t){if(t.length>889)throw n.util.createDOMException("DataError","The encoded key is "+t.length+" characters long, but IE only allows 889 characters. Consider replacing numeric keys with strings to reduce the encoded length.");}var i="__$$compoundKey",l=/\$\$/g,a="$$$$",f="$_$";n.polyfill=h}(idbModules),function(n){"use strict";var t=function(){return{decycle:function(n,t){function e(){i.length===0&&o(c)}function s(n,t){var i=new FileReader;i.onloadend=function(i){var r=i.target.result;n instanceof File;h(r,t,"Blob")};i.readAsDataURL(n)}function h(dataURL,path,blobtype){var encoded=i.indexOf(path);path=path.replace("$","derezObj");eval(path+'.$enc="'+dataURL+'"');eval(path+'.$type="'+blobtype+'"');i.splice(encoded,1);e()}function u(n,t){var e,o,h;if(typeof n!="object"||n===null||n instanceof Boolean||n instanceof Date||n instanceof Number||n instanceof RegExp||n instanceof Blob||n instanceof String)n instanceof Blob?(i.push(t),s(n,t)):n instanceof Boolean?n={$type:"Boolean",$enc:n.toString()}:n instanceof Date?n={$type:"Date",$enc:n.getTime()}:n instanceof Number?n={$type:"Number",$enc:n.toString()}:n instanceof RegExp?n={$type:"RegExp",$enc:n.toString()}:typeof n=="number"?n={$type:"number",$enc:n+""}:n===undefined&&(n={$type:"undefined"});else{for(e=0;e<r.length;e+=1)if(r[e]===n)return{$ref:f[e]};if(r.push(n),f.push(t),Object.prototype.toString.apply(n)==="[object Array]")for(h=[],e=0;e<n.length;e+=1)h[e]=u(n[e],t+"["+e+"]");else{h={};for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(h[o]=u(n[o],t+"["+JSON.stringify(o)+"]"))}return h}return n}var r=[],f=[],i=[],o=t,c=u(n,"$");e()},retrocycle:function(n){function r(n){var o=";base64,",u,t,i,f,e,r;if(n.indexOf(o)===-1)return t=n.split(","),u=t[0].split(":")[1],i=t[1],new Blob([i],{type:u});for(t=n.split(o),u=t[0].split(":")[1],i=window.atob(t[1]),f=i.length,e=new Uint8Array(f),r=0;r<f;++r)e[r]=i.charCodeAt(r);return new Blob([e.buffer],{type:u})}function t(value){var i,item,name,path;if(value&&typeof value=="object")if(Object.prototype.toString.apply(value)==="[object Array]")for(i=0;i<value.length;i+=1)item=value[i],item&&typeof item=="object"&&(path=item.$ref,value[i]=typeof path=="string"&&i.test(path)?eval(path):t(item));else if(value.$type!==undefined)switch(value.$type){case"Blob":case"File":value=r(value.$enc);break;case"Boolean":value=Boolean(value.$enc==="true");break;case"Date":value=new Date(value.$enc);break;case"Number":value=Number(value.$enc);break;case"RegExp":value=eval(value.$enc);break;case"number":value=parseFloat(value.$enc);break;case"undefined":value=undefined}else for(name in value)typeof value[name]=="object"&&(item=value[name],item&&(path=item.$ref,value[name]=typeof path=="string"&&i.test(path)?eval(path):t(item)));return value}var i=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;return t(n)},encode:function(n,t){function i(n){t(JSON.stringify(n))}this.decycle(n,i)},decode:function(n){return this.retrocycle(JSON.parse(n))}}}();n.Sca=t}(idbModules),function(n){"use strict";function u(n){return n=n.toString(32),n.length===1?"0"+n:n}function f(n){return(n+o(11)).slice(0,11)}function i(n){for(var i="",t=0;t<n.length;t++)i+=(31-parseInt(n[t],32)).toString(32);return i}function e(n,t){var i,r,u;return t=parseInt(t,32),t<0?h(parseInt(n,32)*Math.pow(32,t-10)):t<11?(i=n.slice(0,t),i=parseInt(i,32),r=n.slice(t),r=parseInt(r,32)*Math.pow(32,t-11),h(i+r)):(u=n+o(t-11),parseInt(u,32))}function h(n,t){return t=t||16,parseFloat(n.toPrecision(t))}function o(n){for(var t="";n--;)t=t+"0";return t}function c(n){return"-"+n}function l(n){return n instanceof Date?"date":n instanceof Array?"array":typeof n}function a(t){var r=l(t),i;if(r==="array")for(i=0;i<t.length;i++)a(t[i]);else if(!s[r]||r!=="string"&&isNaN(t))throw n.util.createDOMException("DataError","Not a valid key");}function p(source,keyPath){var arrayValue,i;try{if(keyPath instanceof Array){for(arrayValue=[],i=0;i<keyPath.length;i++)arrayValue.push(eval("source."+keyPath[i]));return arrayValue}return eval("source."+keyPath)}catch(e){return undefined}}function w(n,t,i){for(var f,r=t.split("."),u=0;u<r.length-1;u++)f=r[u],n=n[f]=n[f]||{};n[r[r.length-1]]=i}function b(n,i){var r=t[i.substring(0,1)];return r==="array"?i.indexOf(n)>1:i===n}function v(t,i){var u=i.lower===undefined,f=i.upper===undefined,r=n.Key.encode(t,!0);return i.lower!==undefined&&(i.lowerOpen&&r>i.__lower&&(u=!0),!i.lowerOpen&&r>=i.__lower&&(u=!0)),i.upper!==undefined&&(i.upperOpen&&r<i.__upper&&(f=!0),!i.upperOpen&&r<=i.__upper&&(f=!0)),u&&f}function y(n,t){var r=[],u,i,f;if(n instanceof Array)for(u=0;u<n.length;u++){if(i=n[u],i instanceof Array){if(t.lower===t.upper)continue;if(i.length===1)i=i[0];else{f=y(i,t);f.length>0&&r.push(i);continue}}v(i,t)&&r.push(i)}else v(n,t)&&r.push(n);return r}var t=["undefined","number","date","string","array"],r=["negativeInfinity","bigNegative","smallNegative","smallPositive","bigPositive","positiveInfinity"],s={undefined:{encode:function(){return t.indexOf("undefined")+"-"},decode:function(){return undefined}},date:{encode:function(n){return t.indexOf("date")+"-"+n.toJSON()},decode:function(n){return new Date(n.substring(2))}},number:{encode:function(n){var e=Math.abs(n).toString(32),l=e.indexOf("."),a,s,h,c;return e=l!==-1?e.replace(".",""):e,a=e.search(/[^0]/),e=e.slice(a),h=o(2),c=o(11),isFinite(n)?n<0?n>-1?(s=r.indexOf("smallNegative"),h=u(a),c=i(f(e))):(s=r.indexOf("bigNegative"),h=i(u(l!==-1?l:e.length)),c=i(f(e))):n<1?(s=r.indexOf("smallPositive"),h=i(u(a)),c=f(e)):(s=r.indexOf("bigPositive"),h=u(l!==-1?l:e.length),c=f(e)):s=r.indexOf(n>0?"positiveInfinity":"negativeInfinity"),t.indexOf("number")+"-"+s+h+c},decode:function(n){var f=+n.substr(2,1),t=n.substr(3,2),u=n.substr(5,11);switch(r[f]){case"negativeInfinity":return-Infinity;case"positiveInfinity":return Infinity;case"bigPositive":return e(u,t);case"smallPositive":return t=c(i(t)),e(u,t);case"smallNegative":return t=c(t),u=i(u),-e(u,t);case"bigNegative":return t=i(t),u=i(u),-e(u,t);default:throw new Error("Invalid number.");}}},string:{encode:function(n,i){return i&&(n=n.replace(/(.)/g,"-$1")+" "),t.indexOf("string")+"-"+n},decode:function(n,t){return n=n.substring(2),t&&(n=n.substr(0,n.length-1).replace(/-(.)/g,"$1")),n}},array:{encode:function(i){for(var f,e,u=[],r=0;r<i.length;r++)f=i[r],e=n.Key.encode(f,!0),u[r]=e;return u.push(t.indexOf("undefined")+"-"),t.indexOf("array")+"-"+JSON.stringify(u)},decode:function(t){var i=JSON.parse(t.substring(2)),r,u,f;for(i.pop(),r=0;r<i.length;r++)u=i[r],f=n.Key.decode(u,!0),i[r]=f;return i}}};n.Key={encode:function(n,t){return n===undefined?null:s[l(n)].encode(n,t)},decode:function(n,i){return typeof n!="string"?undefined:s[t[n.substring(0,1)]].decode(n,i)},validate:a,getValue:p,setValue:w,isMultiEntryMatch:b,findMultiEntryMatches:y}}(idbModules),function(n){"use strict";function u(n,t){var i=new Event(n);return i.debug=t,Object.defineProperty(i,"target",{writable:!0}),i}function i(n,t){this.type=n;this.debug=t;this.bubbles=!1;this.cancelable=!1;this.eventPhase=0;this.timeStamp=(new Date).valueOf()}var f=!1,t,r;try{t=u("test type","test debug");r={test:"test target"};t.target=r;t instanceof Event&&t.type==="test type"&&t.debug==="test debug"&&t.target===r&&(f=!0)}catch(e){}f?(n.Event=Event,n.IDBVersionChangeEvent=Event,n.util.createEvent=u):(n.Event=i,n.IDBVersionChangeEvent=i,n.util.createEvent=function(n,t){return new i(n,t)})}(idbModules),function(n){"use strict";function i(n,t){var i=new DOMException.prototype.constructor(0,t);return i.name=n||"DOMException",i.message=t,i}function r(n,t){n=n||"DOMError";var i=new DOMError(n,t);return i.name===n||(i.name=n),i.message===t||(i.message=t),i}function u(n,t){var i=new Error(t);return i.name=n||"DOMException",i.message=t,i}n.util.logError=function(t,i,r){if(n.DEBUG){r&&r.message&&(r=r.message);var u=typeof console.error=="function"?"error":"log";console[u](t+": "+i+". "+(r||""));console.trace&&console.trace()}};n.util.findError=function(n){var r,i,t;if(n){if(n.length===1)return n[0];for(i=0;i<n.length;i++){if(t=n[i],t instanceof Error||t instanceof DOMException)return t;t&&typeof t.message=="string"&&(r=t)}}return r};var t,f=!1,e=!1;try{t=i("test name","test message");t instanceof DOMException&&t.name==="test name"&&t.message==="test message"&&(f=!0)}catch(o){}try{t=r("test name","test message");t instanceof DOMError&&t.name==="test name"&&t.message==="test message"&&(e=!0)}catch(o){}f?(n.DOMException=DOMException,n.util.createDOMException=function(t,r,u){return n.util.logError(t,r,u),i(t,r)}):(n.DOMException=Error,n.util.createDOMException=function(t,i,r){return n.util.logError(t,i,r),u(t,i)});e?(n.DOMError=DOMError,n.util.createDOMError=function(t,i,u){return n.util.logError(t,i,u),r(t,i)}):(n.DOMError=Error,n.util.createDOMError=function(t,i,r){return n.util.logError(t,i,r),u(t,i)})}(idbModules),function(n){"use strict";function i(){this.onsuccess=this.onerror=this.result=this.error=this.source=this.transaction=null;this.readyState="pending"}function t(){this.onblocked=this.onupgradeneeded=null}t.prototype=new i;t.prototype.constructor=t;n.IDBRequest=i;n.IDBOpenDBRequest=t}(idbModules),function(n,t){"use strict";function i(i,r,u,f){i!==t&&n.Key.validate(i);r!==t&&n.Key.validate(r);this.lower=i;this.upper=r;this.lowerOpen=!!u;this.upperOpen=!!f}i.only=function(n){return new i(n,n,!1,!1)};i.lowerBound=function(n,r){return new i(n,t,r,t)};i.upperBound=function(n,r){return new i(t,n,t,r)};i.bound=function(n,t,r,u){return new i(n,t,r,u)};n.IDBKeyRange=i}(idbModules),function(n,t){"use strict";function i(i,r,u,f,e,o,s){if(i===null&&(i=t),i===t||i instanceof n.IDBKeyRange||(i=new n.IDBKeyRange(i,i,!1,!1)),u.transaction.__assertActive(),r!==t&&["next","prev","nextunique","prevunique"].indexOf(r)===-1)throw new TypeError(r+"is not a valid cursor direction");this.source=f;this.direction=r||"next";this.key=t;this.primaryKey=t;this.__store=u;this.__range=i;this.__req=new n.IDBRequest;this.__keyColumnName=e;this.__valueColumnName=o;this.__valueDecoder=o==="value"?n.Sca:n.Key;this.__count=s;this.__offset=-1;this.__lastKeyContinued=t;this.__multiEntryIndex=f instanceof n.IDBIndex?f.multiEntry:!1;this.__unique=this.direction.indexOf("unique")!==-1;i!==t&&(i.__lower=i.lower!==t&&n.Key.encode(i.lower,this.__multiEntryIndex),i.__upper=i.upper!==t&&n.Key.encode(i.upper,this.__multiEntryIndex));this["continue"]()}i.prototype.__find=function(){var n=Array.prototype.slice.call(arguments);this.__multiEntryIndex?this.__findMultiEntry.apply(this,n):this.__findBasic.apply(this,n)};i.prototype.__findBasic=function(i,r,u,f,e){var l;e=e||1;var o=this,c=n.util.quote(o.__keyColumnName),s=["SELECT * FROM",n.util.quote(o.__store.name)],h=[];s.push("WHERE",c,"NOT NULL");o.__range&&(o.__range.lower!==t||o.__range.upper!==t)&&(s.push("AND"),o.__range.lower!==t&&(s.push(c,o.__range.lowerOpen?">":">=","?"),h.push(o.__range.__lower)),o.__range.lower!==t&&o.__range.upper!==t&&s.push("AND"),o.__range.upper!==t&&(s.push(c,o.__range.upperOpen?"<":"<=","?"),h.push(o.__range.__upper)));typeof i!="undefined"&&(o.__lastKeyContinued=i,o.__offset=0);o.__lastKeyContinued!==t&&(s.push("AND",c,">= ?"),n.Key.validate(o.__lastKeyContinued),h.push(n.Key.encode(o.__lastKeyContinued)));l=o.direction==="prev"||o.direction==="prevunique"?"DESC":"ASC";o.__count||(s.push("ORDER BY",c,l),s.push("LIMIT",e,"OFFSET",o.__offset));s=s.join(" ");n.DEBUG&&console.log(s,h);o.__prefetchedData=null;o.__prefetchedIndex=0;r.executeSql(s,h,function(i,r){o.__count?u(t,r.rows.length,t):r.rows.length>1?(o.__prefetchedData=r.rows,o.__prefetchedIndex=0,n.DEBUG&&console.log("Preloaded "+o.__prefetchedData.length+" records for cursor"),o.__decode(r.rows.item(0),u)):r.rows.length===1?o.__decode(r.rows.item(0),u):(n.DEBUG&&console.log("Reached end of cursors"),u(t,t,t))},function(t,i){n.DEBUG&&console.log("Could not execute Cursor.continue",s,h);f(i)})};i.prototype.__findMultiEntry=function(i,r,u,f){var e=this,c;if(e.__prefetchedData&&e.__prefetchedData.length===e.__prefetchedIndex){n.DEBUG&&console.log("Reached end of multiEntry cursor");u(t,t,t);return}var h=n.util.quote(e.__keyColumnName),o=["SELECT * FROM",n.util.quote(e.__store.name)],s=[];o.push("WHERE",h,"NOT NULL");e.__range&&e.__range.lower!==t&&e.__range.upper!==t&&e.__range.upper.indexOf(e.__range.lower)===0&&(o.push("AND",h,"LIKE ?"),s.push("%"+e.__range.__lower.slice(0,-1)+"%"));typeof i!="undefined"&&(e.__lastKeyContinued=i,e.__offset=0);e.__lastKeyContinued!==t&&(o.push("AND",h,">= ?"),n.Key.validate(e.__lastKeyContinued),s.push(n.Key.encode(e.__lastKeyContinued)));c=e.direction==="prev"||e.direction==="prevunique"?"DESC":"ASC";e.__count||o.push("ORDER BY key",c);o=o.join(" ");n.DEBUG&&console.log(o,s);e.__prefetchedData=null;e.__prefetchedIndex=0;r.executeSql(o,s,function(i,r){var f,o,h,v,c,l;if(e.__multiEntryOffset=r.rows.length,r.rows.length>0){for(f=[],o=0;o<r.rows.length;o++){var s=r.rows.item(o),y=n.Key.decode(s[e.__keyColumnName],!0),a=n.Key.findMultiEntryMatches(y,e.__range);for(h=0;h<a.length;h++)v=a[h],c={matchingKey:n.Key.encode(v,!0),key:s.key},c[e.__keyColumnName]=s[e.__keyColumnName],c[e.__valueColumnName]=s[e.__valueColumnName],f.push(c)}l=e.direction.indexOf("prev")===0;f.sort(function(n,t){return n.matchingKey.replace("[","z")<t.matchingKey.replace("[","z")?l?1:-1:n.matchingKey.replace("[","z")>t.matchingKey.replace("[","z")?l?-1:1:n.key<t.key?e.direction==="prev"?1:-1:n.key>t.key?e.direction==="prev"?-1:1:0});e.__prefetchedData={data:f,length:f.length,item:function(n){return this.data[n]}};e.__prefetchedIndex=0;e.__count?u(t,f.length,t):f.length>1?(n.DEBUG&&console.log("Preloaded "+e.__prefetchedData.length+" records for multiEntry cursor"),e.__decode(f[0],u)):f.length===1?(n.DEBUG&&console.log("Reached end of multiEntry cursor"),e.__decode(f[0],u)):(n.DEBUG&&console.log("Reached end of multiEntry cursor"),u(t,t,t))}else n.DEBUG&&console.log("Reached end of multiEntry cursor"),u(t,t,t)},function(t,i){n.DEBUG&&console.log("Could not execute Cursor.continue",o,s);f(i)})};i.prototype.__onsuccess=function(n){var i=this;return function(r,u,f){if(i.__count)n(u,i.__req);else{i.key=r===t?null:r;i.value=u===t?null:u;i.primaryKey=f===t?null:f;var e=r===t?null:i;n(e,i.__req)}}};i.prototype.__decode=function(i,r){if(this.__multiEntryIndex&&this.__unique){if(this.__matchedKeys||(this.__matchedKeys={}),this.__matchedKeys[i.matchingKey]){r(t,t,t);return}this.__matchedKeys[i.matchingKey]=!0}var u=n.Key.decode(this.__multiEntryIndex?i.matchingKey:i[this.__keyColumnName],this.__multiEntryIndex),f=this.__valueDecoder.decode(i[this.__valueColumnName]),e=n.Key.decode(i.key);r(u,f,e)};i.prototype["continue"]=function(t){var r=n.cursorPreloadPackSize||100,i=this;this.__store.transaction.__pushToQueue(i.__req,function(n,u,f,e){if(i.__offset++,i.__prefetchedData&&(i.__prefetchedIndex++,i.__prefetchedIndex<i.__prefetchedData.length)){i.__decode(i.__prefetchedData.item(i.__prefetchedIndex),i.__onsuccess(f));return}i.__find(t,n,i.__onsuccess(f),e,r)})};i.prototype.advance=function(i){if(i<=0)throw n.util.createDOMException("Type Error","Count is invalid - 0 or negative",i);var r=this;this.__store.transaction.__pushToQueue(r.__req,function(n,u,f,e){r.__offset+=i;r.__find(t,n,r.__onsuccess(f),e)})};i.prototype.update=function(i){var r=this;return r.__store.transaction.__assertWritable(),r.__store.transaction.__addToTransactionQueue(function(u,f,e,o){n.Sca.encode(i,function(f){r.__find(t,u,function(t,s,h){var c=r.__store,y=[f],l=["UPDATE",n.util.quote(c.name),"SET value = ?"],a,v,p;for(n.Key.validate(h),a=0;a<c.indexNames.length;a++)v=c.__indexes[c.indexNames[a]],p=n.Key.getValue(i,v.keyPath),l.push(",",n.util.quote(v.name),"= ?"),y.push(n.Key.encode(p,v.multiEntry));l.push("WHERE key = ?");y.push(n.Key.encode(h));n.DEBUG&&console.log(l.join(" "),f,t,h);u.executeSql(l.join(" "),y,function(n,i){r.__prefetchedData=null;r.__prefetchedIndex=0;i.rowsAffected===1?e(t):o("No rows with key found"+t)},function(n,t){o(t)})},o)})})};i.prototype["delete"]=function(){var i=this;return i.__store.transaction.__assertWritable(),this.__store.transaction.__addToTransactionQueue(function(r,u,f,e){i.__find(t,r,function(u,o,s){var h="DELETE FROM  "+n.util.quote(i.__store.name)+" WHERE key = ?";n.DEBUG&&console.log(h,u,s);n.Key.validate(s);r.executeSql(h,[n.Key.encode(s)],function(n,r){i.__prefetchedData=null;i.__prefetchedIndex=0;r.rowsAffected===1?(i.__offset--,f(t)):e("No rows with key found"+u)},function(n,t){e(t)})},e)})};n.IDBCursor=i}(idbModules),function(n,t){"use strict";function i(n,t){this.objectStore=n;this.name=t.columnName;this.keyPath=t.keyPath;this.multiEntry=t.optionalParams&&t.optionalParams.multiEntry;this.unique=t.optionalParams&&t.optionalParams.unique;this.__deleted=!!t.__deleted}i.__clone=function(n,t){return new i(t,{columnName:n.name,keyPath:n.keyPath,optionalParams:{multiEntry:n.multiEntry,unique:n.unique}})};i.__createIndex=function(t,r){var f=!!t.__indexes[r.name]&&t.__indexes[r.name].__deleted,u;t.__indexes[r.name]=r;t.indexNames.push(r.name);u=t.transaction;u.__addToTransactionQueue(function(u,e,o,s){function h(t,i){s(n.util.createDOMException(0,'Could not create index "'+r.name+'"',i))}function c(u){i.__updateIndexList(t,u,function(){u.executeSql("SELECT * FROM "+n.util.quote(t.name),[],function(i,u){function f(e){if(e<u.rows.length)try{var c=n.Sca.decode(u.rows.item(e).value),s=n.Key.getValue(c,r.keyPath);s=n.Key.encode(s,r.multiEntry);i.executeSql("UPDATE "+n.util.quote(t.name)+" set "+n.util.quote(r.name)+" = ? where key = ?",[s,u.rows.item(e).key],function(){f(e+1)},h)}catch(l){f(e+1)}else o(t)}n.DEBUG&&console.log("Adding existing "+t.name+" records to the "+r.name+" index");f(0)},h)},h)}if(f)c(u);else{var l=["ALTER TABLE",n.util.quote(t.name),"ADD",n.util.quote(r.name),"BLOB"].join(" ");n.DEBUG&&console.log(l);u.executeSql(l,[],c,h)}})};i.__deleteIndex=function(t,r){t.__indexes[r.name].__deleted=!0;t.indexNames.splice(t.indexNames.indexOf(r.name),1);var u=t.transaction;u.__addToTransactionQueue(function(u,f,e,o){function s(t,i){o(n.util.createDOMException(0,'Could not delete index "'+r.name+'"',i))}i.__updateIndexList(t,u,e,s)})};i.__updateIndexList=function(t,i,r,u){for(var f,e={},o=0;o<t.indexNames.length;o++)f=t.__indexes[t.indexNames[o]],e[f.name]={columnName:f.name,keyPath:f.keyPath,optionalParams:{unique:f.unique,multiEntry:f.multiEntry},deleted:!!f.deleted};n.DEBUG&&console.log("Updating the index list for "+t.name,e);i.executeSql("UPDATE __sys__ set indexList = ? where name = ?",[JSON.stringify(e),t.name],function(){r(t)},u)};i.prototype.__fetchIndexData=function(i,r){var u=this,f,e;return arguments.length===1?(r=i,f=!1):(n.Key.validate(i),e=n.Key.encode(i,u.multiEntry),f=!0),u.objectStore.transaction.__addToTransactionQueue(function(i,o,s,h){var c=["SELECT * FROM",n.util.quote(u.objectStore.name),"WHERE",n.util.quote(u.name),"NOT NULL"],l=[];f&&(u.multiEntry?(c.push("AND",n.util.quote(u.name),"LIKE ?"),l.push("%"+e+"%")):(c.push("AND",n.util.quote(u.name),"= ?"),l.push(e)));n.DEBUG&&console.log("Trying to fetch data for Index",c.join(" "),l);i.executeSql(c.join(" "),l,function(i,o){var h=0,c=null,a,l,v;if(u.multiEntry)for(a=0;a<o.rows.length;a++)l=o.rows.item(a),v=n.Key.decode(l[u.name]),f&&n.Key.isMultiEntryMatch(e,l[u.name])?(h++,c=c||l):f||v===t||(h=h+(v instanceof Array?v.length:1),c=c||l);else h=o.rows.length,c=h&&o.rows.item(0);r==="count"?s(h):h===0?s(t):r==="key"?s(n.Key.decode(c.key)):s(n.Sca.decode(c.value))},h)})};i.prototype.openCursor=function(t,i){return new n.IDBCursor(t,i,this.objectStore,this,this.name,"value").__req};i.prototype.openKeyCursor=function(t,i){return new n.IDBCursor(t,i,this.objectStore,this,this.name,"key").__req};i.prototype.get=function(n){if(arguments.length===0)throw new TypeError("No key was specified");return this.__fetchIndexData(n,"value")};i.prototype.getKey=function(n){if(arguments.length===0)throw new TypeError("No key was specified");return this.__fetchIndexData(n,"key")};i.prototype.count=function(i){return i===t?this.__fetchIndexData("count"):i instanceof n.IDBKeyRange?new n.IDBCursor(i,"next",this.objectStore,this,this.name,"value",!0).__req:this.__fetchIndexData(i,"count")};n.IDBIndex=i}(idbModules),function(n){"use strict";function t(t,i){var u,f,r;this.name=t.name;this.keyPath=JSON.parse(t.keyPath);this.transaction=i;this.autoIncrement=typeof t.autoInc=="string"?t.autoInc==="true":!!t.autoInc;this.__indexes={};this.indexNames=new n.util.StringList;u=JSON.parse(t.indexList);for(f in u)u.hasOwnProperty(f)&&(r=new n.IDBIndex(this,u[f]),this.__indexes[r.name]=r,r.__deleted||this.indexNames.push(r.name))}t.__clone=function(n,i){var r=new t({name:n.name,keyPath:JSON.stringify(n.keyPath),autoInc:JSON.stringify(n.autoIncrement),indexList:"{}"},i);return r.__indexes=n.__indexes,r.indexNames=n.indexNames,r};t.__createObjectStore=function(t,i){t.__objectStores[i.name]=i;t.objectStoreNames.push(i.name);var r=t.__versionTransaction;n.IDBTransaction.__assertVersionChange(r);r.__addToTransactionQueue(function(t,r,u){function f(t,r){throw n.util.createDOMException(0,'Could not create object store "'+i.name+'"',r);}var e=["CREATE TABLE",n.util.quote(i.name),"(key BLOB",i.autoIncrement?"UNIQUE, inc INTEGER PRIMARY KEY AUTOINCREMENT":"PRIMARY KEY",", value BLOB)"].join(" ");n.DEBUG&&console.log(e);t.executeSql(e,[],function(n){n.executeSql("INSERT INTO __sys__ VALUES (?,?,?,?)",[i.name,JSON.stringify(i.keyPath),i.autoIncrement,"{}"],function(){u(i)},f)},f)})};t.__deleteObjectStore=function(t,i){t.__objectStores[i.name]=undefined;t.objectStoreNames.splice(t.objectStoreNames.indexOf(i.name),1);var r=t.__versionTransaction;n.IDBTransaction.__assertVersionChange(r);r.__addToTransactionQueue(function(t,r,u,f){function e(t,i){f(n.util.createDOMException(0,"Could not delete ObjectStore",i))}t.executeSql("SELECT * FROM __sys__ where name = ?",[i.name],function(t,r){r.rows.length>0&&t.executeSql("DROP TABLE "+n.util.quote(i.name),[],function(){t.executeSql("DELETE FROM __sys__ WHERE name = ?",[i.name],function(){u()},e)},e)})})};t.prototype.__validateKey=function(t,i){if(this.keyPath)if(typeof i!="undefined")throw n.util.createDOMException("DataError","The object store uses in-line keys and the key parameter was provided",this);else if(t&&typeof t=="object"){if(i=n.Key.getValue(t,this.keyPath),i===undefined){if(this.autoIncrement)return;throw n.util.createDOMException("DataError","Could not eval key from keyPath");}}else throw n.util.createDOMException("DataError","KeyPath was specified, but value was not an object");else if(typeof i=="undefined"){if(this.autoIncrement)return;throw n.util.createDOMException("DataError","The object store uses out-of-line keys and has no key generator and the key parameter was not provided. ",this);}n.Key.validate(i)};t.prototype.__deriveKey=function(t,i,r,u,f){function s(i){t.executeSql("SELECT * FROM sqlite_sequence where name like ?",[e.name],function(n,t){t.rows.length!==1?i(1):i(t.rows.item(0).seq+1)},function(t,i){f(n.util.createDOMException("DataError","Could not get the auto increment value for key",i))})}var e=this,o;e.keyPath?(o=n.Key.getValue(i,e.keyPath),o===undefined&&e.autoIncrement?s(function(t){try{n.Key.setValue(i,e.keyPath,t);u(t)}catch(r){f(n.util.createDOMException("DataError","Could not assign a generated value to the keyPath",r))}}):u(o)):typeof r=="undefined"&&e.autoIncrement?s(u):u(r)};t.prototype.__insertData=function(t,i,r,u,f,e){var o,s,h,v,y;try{for(o={},typeof u!="undefined"&&(n.Key.validate(u),o.key=n.Key.encode(u)),s=0;s<this.indexNames.length;s++)h=this.__indexes[this.indexNames[s]],o[h.name]=n.Key.encode(n.Key.getValue(r,h.keyPath),h.multiEntry);var l=["INSERT INTO ",n.util.quote(this.name),"("],a=[" VALUES ("],c=[];for(v in o)l.push(n.util.quote(v)+","),a.push("?,"),c.push(o[v]);l.push("value )");a.push("?)");c.push(i);y=l.join(" ")+a.join(" ");n.DEBUG&&console.log("SQL for adding",y,c);t.executeSql(y,c,function(){n.Sca.encode(u,function(t){t=n.Sca.decode(t);f(t)})},function(t,i){e(n.util.createDOMError("ConstraintError",i.message,i))})}catch(p){e(p)}};t.prototype.add=function(t,i){var r=this,u;if(arguments.length===0)throw new TypeError("No value was specified");return this.__validateKey(t,i),r.transaction.__assertWritable(),u=r.transaction.__createRequest(),r.transaction.__pushToQueue(u,function(u,f,e,o){r.__deriveKey(u,t,i,function(i){n.Sca.encode(t,function(n){r.__insertData(u,n,t,i,e,o)})},o)}),u};t.prototype.put=function(t,i){var r=this,u;if(arguments.length===0)throw new TypeError("No value was specified");return this.__validateKey(t,i),r.transaction.__assertWritable(),u=r.transaction.__createRequest(),r.transaction.__pushToQueue(u,function(u,f,e,o){r.__deriveKey(u,t,i,function(i){n.Sca.encode(t,function(f){n.Key.validate(i);var s="DELETE FROM "+n.util.quote(r.name)+" where key = ?";u.executeSql(s,[n.Key.encode(i)],function(u,s){n.DEBUG&&console.log("Did the row with the",i,"exist? ",s.rowsAffected);r.__insertData(u,f,t,i,e,o)},function(n,t){o(t)})})},o)}),u};t.prototype.get=function(t){var i=this,r;if(arguments.length===0)throw new TypeError("No key was specified");return n.Key.validate(t),r=n.Key.encode(t),i.transaction.__addToTransactionQueue(function(t,u,f,e){n.DEBUG&&console.log("Fetching",i.name,r);t.executeSql("SELECT * FROM "+n.util.quote(i.name)+" where key = ?",[r],function(t,i){n.DEBUG&&console.log("Fetched data",i);var r;try{if(0===i.rows.length)return f();r=n.Sca.decode(i.rows.item(0).value)}catch(u){n.DEBUG&&console.log(u)}f(r)},function(n,t){e(t)})})};t.prototype["delete"]=function(t){var i=this,r;if(arguments.length===0)throw new TypeError("No key was specified");return i.transaction.__assertWritable(),n.Key.validate(t),r=n.Key.encode(t),i.transaction.__addToTransactionQueue(function(t,u,f,e){n.DEBUG&&console.log("Fetching",i.name,r);t.executeSql("DELETE FROM "+n.util.quote(i.name)+" where key = ?",[r],function(t,i){n.DEBUG&&console.log("Deleted from database",i.rowsAffected);f()},function(n,t){e(t)})})};t.prototype.clear=function(){var t=this;return t.transaction.__assertWritable(),t.transaction.__addToTransactionQueue(function(i,r,u,f){i.executeSql("DELETE FROM "+n.util.quote(t.name),[],function(t,i){n.DEBUG&&console.log("Cleared all records from database",i.rowsAffected);u()},function(n,t){f(t)})})};t.prototype.count=function(t){if(t instanceof n.IDBKeyRange)return new n.IDBCursor(t,"next",this,this,"key","value",!0).__req;var r=this,i=!1;return t!==undefined&&(i=!0,n.Key.validate(t)),r.transaction.__addToTransactionQueue(function(u,f,e,o){var h="SELECT * FROM "+n.util.quote(r.name)+(i?" WHERE key = ?":""),s=[];i&&s.push(n.Key.encode(t));u.executeSql(h,s,function(n,t){e(t.rows.length)},function(n,t){o(t)})})};t.prototype.openCursor=function(t,i){return new n.IDBCursor(t,i,this,this,"key","value").__req};t.prototype.index=function(t){if(arguments.length===0)throw new TypeError("No index name was specified");var i=this.__indexes[t];if(!i)throw n.util.createDOMException("NotFoundError",'Index "'+t+'" does not exist on '+this.name);return n.IDBIndex.__clone(i,this)};t.prototype.createIndex=function(t,i,r){if(arguments.length===0)throw new TypeError("No index name was specified");if(arguments.length===1)throw new TypeError("No key path was specified");if(i instanceof Array&&r&&r.multiEntry)throw n.util.createDOMException("InvalidAccessError","The keyPath argument was an array and the multiEntry option is true.");if(this.__indexes[t]&&!this.__indexes[t].__deleted)throw n.util.createDOMException("ConstraintError",'Index "'+t+'" already exists on '+this.name);this.transaction.__assertVersionChange();r=r||{};var f={columnName:t,keyPath:i,optionalParams:{unique:!!r.unique,multiEntry:!!r.multiEntry}},u=new n.IDBIndex(this,f);return n.IDBIndex.__createIndex(this,u),u};t.prototype.deleteIndex=function(t){if(arguments.length===0)throw new TypeError("No index name was specified");var i=this.__indexes[t];if(!i)throw n.util.createDOMException("NotFoundError",'Index "'+t+'" does not exist on '+this.name);this.transaction.__assertVersionChange();n.IDBIndex.__deleteIndex(this,i)};n.IDBObjectStore=t}(idbModules),function(n){"use strict";function t(n,t,r){this.__id=++i;this.__active=!0;this.__running=!1;this.__errored=!1;this.__requests=[];this.__storeNames=t;this.mode=r;this.db=n;this.error=null;this.onabort=this.onerror=this.oncomplete=null;var u=this;setTimeout(function(){u.__executeRequests()},0)}var i=0;t.prototype.__executeRequests=function(){function i(i){if(n.util.logError("Error","An error occurred in a transaction",i),!t.__errored){if(t.__errored=!0,!t.__active)throw i;try{t.error=i;var r=n.util.createEvent("error");n.util.callback("onerror",t,r);n.util.callback("onerror",t.db,r)}finally{t.abort()}}}function r(){n.DEBUG&&console.log("Transaction completed");var i=n.util.createEvent("complete");try{n.util.callback("oncomplete",t,i);n.util.callback("__oncomplete",t,i)}catch(r){t.__errored=!0;throw r;}}if(this.__running){n.DEBUG&&console.log("Looks like the request set is already running",this.mode);return}this.__running=!0;var t=this;t.db.__db.transaction(function(u){function h(t,i){i&&(f.req=i);f.req.readyState="done";f.req.result=t;delete f.req.error;var r=n.util.createEvent("success");n.util.callback("onsuccess",f.req,r);e++;s()}function o(t,r){r=n.util.findError(arguments);try{f.req.readyState="done";f.req.error=r||"DOMError";f.req.result=undefined;var u=n.util.createEvent("error",r);n.util.callback("onerror",f.req,u)}finally{i(r)}}function s(){if(e>=t.__requests.length)t.__requests=[],t.__active&&(t.__active=!1,r());else try{f=t.__requests[e];f.op(u,f.args,h,o)}catch(n){o(n)}}t.__tx=u;var f=null,e=0;s()},function(n){i(n)})};t.prototype.__createRequest=function(){var t=new n.IDBRequest;return t.source=this.db,t.transaction=this,t};t.prototype.__addToTransactionQueue=function(n,t){var i=this.__createRequest();return this.__pushToQueue(i,n,t),i};t.prototype.__pushToQueue=function(n,t,i){this.__assertActive();this.__requests.push({op:t,args:i,req:n})};t.prototype.__assertActive=function(){if(!this.__active)throw n.util.createDOMException("TransactionInactiveError","A request was placed against a transaction which is currently not active, or which is finished");};t.prototype.__assertWritable=function(){if(this.mode===t.READ_ONLY)throw n.util.createDOMException("ReadOnlyError","The transaction is read only");};t.prototype.__assertVersionChange=function(){t.__assertVersionChange(this)};t.__assertVersionChange=function(i){if(!i||i.mode!==t.VERSION_CHANGE)throw n.util.createDOMException("InvalidStateError","Not a version transaction");};t.prototype.objectStore=function(i){if(arguments.length===0)throw new TypeError("No object store name was specified");if(!this.__active)throw n.util.createDOMException("InvalidStateError","A request was placed against a transaction which is currently not active, or which is finished");if(this.__storeNames.indexOf(i)===-1&&this.mode!==t.VERSION_CHANGE)throw n.util.createDOMException("NotFoundError",i+" is not participating in this transaction");var r=this.db.__objectStores[i];if(!r)throw n.util.createDOMException("NotFoundError",i+" does not exist in "+this.db.name);return n.IDBObjectStore.__clone(r,this)};t.prototype.abort=function(){var t=this,i;n.DEBUG&&console.log("The transaction was aborted",t);t.__active=!1;i=n.util.createEvent("abort");setTimeout(function(){n.util.callback("onabort",t,i)},0)};t.READ_ONLY="readonly";t.READ_WRITE="readwrite";t.VERSION_CHANGE="versionchange";n.IDBTransaction=t}(idbModules),function(n){"use strict";function t(t,i,r,u){var f,e;for(this.__db=t,this.__closed=!1,this.version=r,this.name=i,this.onabort=this.onerror=this.onversionchange=null,this.__objectStores={},this.objectStoreNames=new n.util.StringList,f=0;f<u.rows.length;f++)e=new n.IDBObjectStore(u.rows.item(f)),this.__objectStores[e.name]=e,this.objectStoreNames.push(e.name)}t.prototype.createObjectStore=function(t,i){if(arguments.length===0)throw new TypeError("No object store name was specified");if(this.__objectStores[t])throw n.util.createDOMException("ConstraintError",'Object store "'+t+'" already exists in '+this.name);this.__versionTransaction.__assertVersionChange();i=i||{};var u={name:t,keyPath:JSON.stringify(i.keyPath||null),autoInc:JSON.stringify(i.autoIncrement),indexList:"{}"},r=new n.IDBObjectStore(u,this.__versionTransaction);return n.IDBObjectStore.__createObjectStore(this,r),r};t.prototype.deleteObjectStore=function(t){if(arguments.length===0)throw new TypeError("No object store name was specified");var i=this.__objectStores[t];if(!i)throw n.util.createDOMException("NotFoundError",'Object store "'+t+'" does not exist in '+this.name);this.__versionTransaction.__assertVersionChange();n.IDBObjectStore.__deleteObjectStore(this,i)};t.prototype.close=function(){this.__closed=!0};t.prototype.transaction=function(t,i){var r;if(this.__closed)throw n.util.createDOMException("InvalidStateError","An attempt was made to start a new transaction on a database connection that is not open");if(typeof i=="number"?(i=i===1?IDBTransaction.READ_WRITE:IDBTransaction.READ_ONLY,n.DEBUG&&console.log("Mode should be a string, but was specified as ",i)):i=i||IDBTransaction.READ_ONLY,i!==IDBTransaction.READ_ONLY&&i!==IDBTransaction.READ_WRITE)throw new TypeError("Invalid transaction mode: "+i);if(t=typeof t=="string"?[t]:t,t.length===0)throw n.util.createDOMException("InvalidAccessError","No object store names were specified");for(r=0;r<t.length;r++)if(!this.objectStoreNames.contains(t[r]))throw n.util.createDOMException("NotFoundError",'The "'+t[r]+'" object store does not exist');return new n.IDBTransaction(this,t,i)};n.IDBDatabase=t}(idbModules),function(n){"use strict";function u(i,u){function f(t,i){i=n.util.findError(arguments);n.DEBUG&&console.log("Error in sysdb transaction - when creating dbVersions",i);u(i)}t?i():(t=window.openDatabase("__sysdb__",1,"System Database",r),t.transaction(function(n){n.executeSql("CREATE TABLE IF NOT EXISTS dbVersions (name VARCHAR(255), version INT);",[],i,f)},f))}function i(){this.modules=n}var r=4194304,t;i.prototype.open=function(i,f){function o(t,i){if(!s){i=n.util.findError(arguments);s=!0;var r=n.util.createEvent("error",arguments);e.readyState="done";e.error=i||"DOMError";n.util.callback("onerror",e,r)}}function h(u){var s=window.openDatabase(i,1,i,r),h;if(e.readyState="done",typeof f=="undefined"&&(f=u||1),f<=0||u>f){h=n.util.createDOMError("VersionError","An attempt was made to open a database using a lower version than the existing version.",f);o(h);return}s.transaction(function(r){r.executeSql("CREATE TABLE IF NOT EXISTS __sys__ (name VARCHAR(255), keyPath VARCHAR(255), autoInc BOOLEAN, indexList BLOB)",[],function(){r.executeSql("SELECT * FROM __sys__",[],function(r,h){var c=n.util.createEvent("success");e.source=e.result=new n.IDBDatabase(s,i,f,h);u<f?t.transaction(function(t){t.executeSql("UPDATE dbVersions set version = ? where name = ?",[f,i],function(){var t=n.util.createEvent("upgradeneeded");t.oldVersion=u;t.newVersion=f;e.transaction=e.result.__versionTransaction=new n.IDBTransaction(e.source,[],n.IDBTransaction.VERSION_CHANGE);e.transaction.__addToTransactionQueue(function(i,r,u){n.util.callback("onupgradeneeded",e,t);u()});e.transaction.__oncomplete=function(){e.transaction=null;var t=n.util.createEvent("success");n.util.callback("onsuccess",e,t)}},o)},o):n.util.callback("onsuccess",e,c)},o)},o)},o)}var e=new n.IDBOpenDBRequest,s=!1;if(arguments.length===0)throw new TypeError("Database name is required");else if(arguments.length===2&&(f=parseFloat(f),isNaN(f)||!isFinite(f)||f<=0))throw new TypeError("Invalid database version: "+f);return i=i+"",u(function(){t.transaction(function(n){n.executeSql("SELECT * FROM dbVersions where name = ?",[i],function(n,t){t.rows.length===0?n.executeSql("INSERT INTO dbVersions VALUES (?,?)",[i,f||1],function(){h(0)},o):h(t.rows.item(0).version)},o)},o)},o),e};i.prototype.deleteDatabase=function(i){function e(t,i){if(!s){i=n.util.findError(arguments);f.readyState="done";f.error=i||"DOMError";var r=n.util.createEvent("error");r.debug=arguments;n.util.callback("onerror",f,r);s=!0}}function h(){t.transaction(function(t){t.executeSql("DELETE FROM dbVersions where name = ? ",[i],function(){f.result=undefined;var t=n.util.createEvent("success");t.newVersion=null;t.oldVersion=o;n.util.callback("onsuccess",f,t)},e)},e)}var f=new n.IDBOpenDBRequest,s=!1,o=null;if(arguments.length===0)throw new TypeError("Database name is required");return i=i+"",u(function(){t.transaction(function(t){t.executeSql("SELECT * FROM dbVersions where name = ?",[i],function(t,u){var s,c;if(u.rows.length===0){f.result=undefined;s=n.util.createEvent("success");s.newVersion=null;s.oldVersion=o;n.util.callback("onsuccess",f,s);return}o=u.rows.item(0).version;c=window.openDatabase(i,1,i,r);c.transaction(function(t){t.executeSql("SELECT * FROM __sys__",[],function(t,i){var r=i.rows;(function u(i){i>=r.length?t.executeSql("DROP TABLE IF EXISTS __sys__",[],function(){h()},e):t.executeSql("DROP TABLE "+n.util.quote(r.item(i).name),[],function(){u(i+1)},function(){u(i+1)})})(0)},function(){h()})})},e)},e)},e),f};i.prototype.cmp=function(t,i){var r,u;if(arguments.length<2)throw new TypeError("You must provide two keys to be compared");n.Key.validate(t);n.Key.validate(i);var f=n.Key.encode(t),e=n.Key.encode(i),o=f>e?1:f===e?0:-1;return n.DEBUG&&(r=n.Key.decode(f),u=n.Key.decode(e),typeof t=="object"&&(t=JSON.stringify(t),r=JSON.stringify(r)),typeof i=="object"&&(i=JSON.stringify(i),u=JSON.stringify(u)),r!==t&&console.warn(t+" was incorrectly encoded as "+r),u!==i&&console.warn(i+" was incorrectly encoded as "+u)),o};n.shimIndexedDB=new i;n.IDBFactory=i}(idbModules),function(n,t){"use strict";function i(t,i){try{n[t]=i}catch(r){}if(n[t]!==i&&Object.defineProperty){try{Object.defineProperty(n,t,{value:i})}catch(r){}n[t]!==i&&n.console&&console.warn&&console.warn("Unable to shim "+t)}}i("shimIndexedDB",t.shimIndexedDB);n.shimIndexedDB&&(n.shimIndexedDB.__useShim=function(){typeof n.openDatabase!="undefined"?(i("indexedDB",t.shimIndexedDB),i("IDBFactory",t.IDBFactory),i("IDBDatabase",t.IDBDatabase),i("IDBObjectStore",t.IDBObjectStore),i("IDBIndex",t.IDBIndex),i("IDBTransaction",t.IDBTransaction),i("IDBCursor",t.IDBCursor),i("IDBKeyRange",t.IDBKeyRange),i("IDBRequest",t.IDBRequest),i("IDBOpenDBRequest",t.IDBOpenDBRequest),i("IDBVersionChangeEvent",t.IDBVersionChangeEvent)):typeof n.indexedDB=="object"&&t.polyfill()},n.shimIndexedDB.__debug=function(n){t.DEBUG=n});"indexedDB"in n||(n.indexedDB=n.indexedDB||n.webkitIndexedDB||n.mozIndexedDB||n.oIndexedDB||n.msIndexedDB);var r=!1;if((navigator.userAgent.match(/Android 2/)||navigator.userAgent.match(/Android 3/)||navigator.userAgent.match(/Android 4\.[0-3]/))&&(navigator.userAgent.match(/Chrome/)||(r=!0)),(typeof n.indexedDB=="undefined"||!n.indexedDB||r)&&typeof n.openDatabase!="undefined")n.shimIndexedDB.__useShim();else{n.IDBDatabase=n.IDBDatabase||n.webkitIDBDatabase;n.IDBTransaction=n.IDBTransaction||n.webkitIDBTransaction;n.IDBCursor=n.IDBCursor||n.webkitIDBCursor;n.IDBKeyRange=n.IDBKeyRange||n.webkitIDBKeyRange;n.IDBTransaction||(n.IDBTransaction={});try{n.IDBTransaction.READ_ONLY=n.IDBTransaction.READ_ONLY||"readonly";n.IDBTransaction.READ_WRITE=n.IDBTransaction.READ_WRITE||"readwrite"}catch(u){}}}(window,idbModules),function(n){"use strict";var o=n.IDBKeyRange||n.webkitIDBKeyRange,t={readonly:"readonly",readwrite:"readwrite"},s=Object.prototype.hasOwnProperty,h=function(n){return n},i=function(){if(!i&&(i=n.indexedDB||n.webkitIndexedDB||n.mozIndexedDB||n.oIndexedDB||n.msIndexedDB||(n.indexedDB===null&&n.shimIndexedDB?n.shimIndexedDB:undefined),!i))throw new Error("IndexedDB required");return i}(),r={},f=Array.isArray,c=function(n,i){var e=this,u=!1;this.getIndexedDB=function(){return n};this.add=function(i){var r,e,h;if(u)throw new Error("Database has been closed");r=[];for(var s=arguments.length,c=Array(s>1?s-1:0),o=1;o<s;o++)c[o-1]=arguments[o];return c.forEach(function(n){f(n)?r=r.concat(n):r.push(n)}),e=n.transaction(i,t.readwrite),h=e.objectStore(i),new Promise(function(n,t){var i=this;r.forEach(function(n){var t,i;n.item&&n.key?(i=n.key,n=n.item,t=h.add(n,i)):t=h.add(n);t.onsuccess=function(t){var r=t.target,i=r.source.keyPath;i===null&&(i="__id__");Object.defineProperty(n,i,{value:r.result,enumerable:!0})}});e.oncomplete=function(){return n(r,i)};e.onerror=function(n){n.preventDefault();t(n)};e.onabort=function(n){return t(n)}})};this.update=function(i){if(u)throw new Error("Database has been closed");for(var e=n.transaction(i,t.readwrite),h=e.objectStore(i),r=[],s=arguments.length,c=Array(s>1?s-1:0),o=1;o<s;o++)c[o-1]=arguments[o];return c.forEach(function(n){f(n)?r=r.concat(n):r.push(n)}),new Promise(function(n,t){var i=this;r.forEach(function(n){if(n.item&&n.key){var t=n.key;n=n.item;h.put(n,t)}else h.put(n)});e.oncomplete=function(){return n(r,i)};e.onerror=function(n){return t(n)};e.onabort=function(n){return t(n)}})};this.remove=function(i,r){if(u)throw new Error("Database has been closed");var f=n.transaction(i,t.readwrite),e=f.objectStore(i);return new Promise(function(n,t){e.delete(r);f.oncomplete=function(){return n(r)};f.onerror=function(n){return t(n)}})};this.clear=function(i){if(u)throw new Error("Database has been closed");var r=n.transaction(i,t.readwrite),f=r.objectStore(i);return f.clear(),new Promise(function(n,t){r.oncomplete=function(){return n()};r.onerror=function(n){return t(n)}})};this.close=function(){if(u)throw new Error("Database has been closed");n.close();u=!0;delete r[i]};this.get=function(t,i){if(u)throw new Error("Database has been closed");var r=n.transaction(t),f=r.objectStore(t),e=f.get(i);return new Promise(function(n,t){e.onsuccess=function(t){return n(t.target.result)};r.onerror=function(n){return t(n)}})};this.query=function(t,i){if(u)throw new Error("Database has been closed");return new l(t,n,i)};this.count=function(t){if(u)throw new Error("Database has been closed");var i=n.transaction(t),r=i.objectStore(t);return new Promise(function(n,t){var u=r.count();u.onsuccess=function(t){return n(t.target.result)};i.onerror=function(n){return t(n)}})};[].map.call(n.objectStoreNames,function(n){e[n]={};var t=Object.keys(e);t.filter(function(n){return n!=="close"}).map(function(t){return e[n][t]=function(){for(var r=arguments.length,u=Array(r),i=0;i<r;i++)u[i]=arguments[i];return e[t].apply(e,[n].concat(u))}})})},l=function(n,i,r){var e=this,u=!1,s=function(f,e,s,h,c,l,a){var v=i.transaction(n,u?t.readwrite:t.readonly),b=v.objectStore(n),k=r?b.index(r):b,nt=f?o[f].apply(null,e):null,p=[],d=[nt],y=0,w,g;return c=c||null,l=l||[],s!=="count"&&d.push(h||"next"),w=u?Object.keys(u):!1,g=function(n){for(var r,t,i=0;i<w.length;i++)r=w[i],t=u[r],t instanceof Function&&(t=t(n)),n[r]=t;return n},k[s].apply(k,d).onsuccess=function(n){var t=n.target.result,r,i;typeof t=="number"?p=t:t&&(c!==null&&c[0]>y?(y=c[0],t.advance(c[0])):c!==null&&y>=c[0]+c[1]||(r=!0,i="value"in t?t.value:t.key,l.forEach(function(n){n&&n.length&&(r=n.length===2?r&&i[n[0]]===n[1]:r&&n[0].apply(undefined,[i]))}),r&&(y++,p.push(a(i)),u&&(i=g(i),t.update(i))),t.continue()))},new Promise(function(n,t){v.oncomplete=function(){return n(p)};v.onerror=function(n){return t(n)};v.onabort=function(n){return t(n)}})},f=function(n,t){var a="next",y="openCursor",b=[],v=null,k=h,d=!1,i=function(){return s(n,t,y,d?a+"unique":a,v,b,k)},p=function(){return v=Array.prototype.slice.call(arguments,0,2),v.length===1&&v.unshift(0),{execute:i}},w=function(){return a=null,y="count",{execute:i}},r,e,o,c,f,l=function(){return y="openKeyCursor",{desc:e,execute:i,filter:r,distinct:o,map:f}};return r=function(){return b.push(Array.prototype.slice.call(arguments,0,2)),{keys:l,execute:i,filter:r,desc:e,distinct:o,modify:c,limit:p,map:f}},e=function(){return a="prev",{keys:l,execute:i,filter:r,distinct:o,modify:c,map:f}},o=function(){return d=!0,{keys:l,count:w,execute:i,filter:r,desc:e,modify:c,map:f}},c=function(n){return u=n,{execute:i}},f=function(n){return k=n,{execute:i,count:w,keys:l,filter:r,desc:e,distinct:o,modify:c,limit:p,map:f}},{execute:i,count:w,keys:l,filter:r,desc:e,distinct:o,modify:c,limit:p,map:f}};["only","bound","upperBound","lowerBound"].forEach(function(n){e[n]=function(){return f(n,arguments)}});this.range=function(n){var t=Object.keys(n).sort(),r,e,i,u;if(t.length===1){r=t[0];e=n[r];switch(r){case"eq":i="only";break;case"gt":i="lowerBound";u=!0;break;case"lt":i="upperBound";u=!0;break;case"gte":i="lowerBound";break;case"lte":i="upperBound";break;default:throw new TypeError("`"+r+"` is not valid key");}return new f(i,[e,u])}var s=n[t[0]],h=n[t[1]],o=t.join("-");switch(o){case"gt-lt":case"gt-lte":case"gte-lt":case"gte-lte":return new f("bound",[s,h,t[0]==="gt",t[1]==="lt"]);default:throw new TypeError("`"+o+"` are conflicted keys");}};this.filter=function(){var n=f(null,null);return n.filter.apply(n,arguments)};this.all=function(){return this.filter()}},a=function(n,t,i){var r,f,o,u,e;typeof t=="function"&&(t=t());for(r in t){f=t[r];o=!s.call(t,r)||i.objectStoreNames.contains(r)?n.currentTarget.transaction.objectStore(r):i.createObjectStore(r,f.key);for(u in f.indexes){e=f.indexes[u];try{o.index(u)}catch(h){o.createIndex(u,e.key||u,Object.keys(e).length?e:{unique:!1})}}}},e=function(n,t){var i=n.target.result,u=new c(i,t);return r[t]=i,Promise.resolve(u)},u={version:"0.11.0",open:function(t){return new Promise(function(u,f){if(r[t.server])e({target:{result:r[t.server]}},t.server,t.version,t.schema).then(u,f);else{var o=i.open(t.server,t.version);o.onsuccess=function(n){return e(n,t.server,t.version,t.schema).then(u,f)};o.onupgradeneeded=function(i){try{if(n.localStorage){console.log("abc");var r=10;Object.keys(localStorage).forEach(function(n){n.substring(0,r)=="LatestSync"&&localStorage.removeItem(n)})}}catch(i){}return a(i,t.schema,i.target.result)};o.onerror=function(n){return f(n)}}})},"delete":function(n){return new Promise(function(t,r){var u=i.deleteDatabase(n);u.onsuccess=function(){return t()};u.onerror=function(n){return r(n)};u.onblocked=function(n){return r(n)}})}};typeof module!="undefined"&&typeof module.exports!="undefined"?module.exports=u:typeof define=="function"&&define.amd?define(function(){return u}):n.db=u}(window)